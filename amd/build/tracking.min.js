/**
 * This plugin provides access to Moodle data in form of analytics and reports in real time.
 *
 * @copyright  2020 IntelliBoard, Inc
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @see    https://intelliboard.net/
 */
define(["jquery","core/log","local_intellidata/tracking_repository","local_intellidata/cookies_helper"],function(n,t,e,o){var A={AJAXFREQUENCY:30,INACTIVITY:60,PERIOD:1e3,INTERVAL:null,PAGE:"",PARAM:"",MEDIATRACK:0},i={COUNTER:0,AJAXCOUNTER:0,WARNINGTIME:0,LOGOUTTIME:0},a=function(){i.COUNTER=0,i.WARNINGTIME=0,i.LOGOUTTIME=0},E=function(){o.setCookie("intellidatapage",A.PAGE),o.setCookie("intellidataparam",A.PARAM),o.setCookie("intellidatatime",A.AJAXFREQUENCY)},l=function(){A.MEDIATRACK&&c()&&!document.hidden&&a(),i.COUNTER<=A.INACTIVITY&&(i.COUNTER++,i.AJAXCOUNTER++,i.AJAXCOUNTER==A.AJAXFREQUENCY&&A.AJAXFREQUENCY&&(e.sendRequest(A.PAGE,A.PARAM),i.AJAXCOUNTER=0))},c=function(){var n=[],t=!1,e=document.querySelectorAll("audio,video"),o=document.querySelectorAll("iframe");return o.length&&o.forEach(function(e){e=e.contentWindow.document.querySelectorAll("audio,video");e.length&&e.forEach(function(e){n.push(e)})}),e.length&&e.forEach(function(e){n.push(e)}),n.length&&n.forEach(function(e){e.paused||(t=!0)}),t};return{init:function(e){e=e,A.INACTIVITY=e.inactivity||A.INACTIVITY,A.AJAXFREQUENCY=e.ajaxfrequency||A.AJAXFREQUENCY,A.PERIOD=e.period||A.PERIOD,A.PAGE=e.page||A.PAGE,A.PARAM=e.param||A.PARAM,A.MEDIATRACK=e.mediatrack||A.MEDIATRACK,t.debug("IntelliData: Set Params",[A,i]),n(document).on("mousemove",a),n(document).on("keypress",a),n(document).on("scroll",a),n(window).on("unload",E),setInterval(l,A.PERIOD),t.debug("IntelliData: Start Tracking",[A,i])}}});

//# sourceMappingURL=tracking.min.js.map